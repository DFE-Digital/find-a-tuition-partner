name: End to End Testing

on:
  workflow_dispatch:
    inputs:
      environment:
        description: 'Target environment for the End to End tests'
        required: true
        default: development
        type: choice
        options:
          - development
          - research
          - staging
          - production

jobs:
  end-to-end-testing:
    runs-on: ubuntu-latest
    concurrency: e2e-${{ inputs.environment }}

    steps:
      - name: checkout
        uses: actions/checkout@v2
        
      - name: End to End Testing
        uses: ./.github/actions/end-to-end-testing
        with:
          az_resource_group_name: ${{ secrets.AZURE_RESOURCE_GROUP  }}
          az_webapp_name: ${{ secrets.AZURE_WEBAPP_NAME }}
          az_tenant_id: ${{ env.ARM_TENANT_ID }}
          az_subscription_id: ${{ env.ARM_SUBSCRIPTION_ID }}
          az_client_id: ${{ env.ARM_CLIENT_ID }}
          az_client_secret: ${{ env.ARM_CLIENT_SECRET }}
